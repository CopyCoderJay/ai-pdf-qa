{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\sanja\\\\Pdfc\\\\src\\\\components\\\\ChatInterface.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from 'react';\nimport { Send, AlertCircle, Plus } from 'lucide-react';\nimport axios from 'axios';\n\n// Add your Gemini API key here\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst GEMINI_API_KEY = \"AIzaSyAVnKwouHnPokho-KTK7KaEWQ4-1VuXm1g\";\nconst GEMINI_API_URL = \"https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent\";\nconst callGemini = async prompt => {\n  var _response$data, _response$data$candid;\n  const response = await axios.post(GEMINI_API_URL, {\n    contents: [{\n      parts: [{\n        text: prompt\n      }]\n    }],\n    generationConfig: {\n      temperature: 0.7,\n      topK: 40,\n      topP: 0.95,\n      maxOutputTokens: 1024\n    },\n    safetySettings: [{\n      category: \"HARM_CATEGORY_HARASSMENT\",\n      threshold: \"BLOCK_MEDIUM_AND_ABOVE\"\n    }, {\n      category: \"HARM_CATEGORY_HATE_SPEECH\",\n      threshold: \"BLOCK_MEDIUM_AND_ABOVE\"\n    }, {\n      category: \"HARM_CATEGORY_SEXUALLY_EXPLICIT\",\n      threshold: \"BLOCK_MEDIUM_AND_ABOVE\"\n    }, {\n      category: \"HARM_CATEGORY_DANGEROUS_CONTENT\",\n      threshold: \"BLOCK_MEDIUM_AND_ABOVE\"\n    }]\n  }, {\n    headers: {\n      'Content-Type': 'application/json',\n      'x-goog-api-key': GEMINI_API_KEY\n    },\n    timeout: 30000\n  });\n  if (((_response$data = response.data) === null || _response$data === void 0 ? void 0 : (_response$data$candid = _response$data.candidates) === null || _response$data$candid === void 0 ? void 0 : _response$data$candid.length) > 0) {\n    var _response$data$candid2, _response$data$candid3, _response$data$candid4, _response$data$candid5;\n    const t = ((_response$data$candid2 = response.data.candidates[0]) === null || _response$data$candid2 === void 0 ? void 0 : (_response$data$candid3 = _response$data$candid2.content) === null || _response$data$candid3 === void 0 ? void 0 : (_response$data$candid4 = _response$data$candid3.parts) === null || _response$data$candid4 === void 0 ? void 0 : (_response$data$candid5 = _response$data$candid4[0]) === null || _response$data$candid5 === void 0 ? void 0 : _response$data$candid5.text) || '';\n    return t.trim() || 'I could not generate an answer.';\n  }\n  throw new Error('Invalid response from Gemini');\n};\nconst ChatInterface = ({\n  conversationHistory,\n  onNewMessage,\n  documentInfo,\n  suggestedQuestion,\n  onSuggestedQuestionUsed,\n  onUploadFile\n}) => {\n  _s();\n  const [inputMessage, setInputMessage] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState('');\n  const messagesEndRef = useRef(null);\n  const fileInputRef = useRef(null);\n\n  // Set suggested question when it changes\n  useEffect(() => {\n    if (suggestedQuestion) {\n      setInputMessage(suggestedQuestion);\n    }\n  }, [suggestedQuestion]);\n  const scrollToBottom = () => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: 'smooth'\n    });\n  };\n  useEffect(() => {\n    scrollToBottom();\n  }, [conversationHistory]);\n  const handleSendMessage = async () => {\n    if (!inputMessage.trim() || isLoading) return;\n    // Allow asking even before upload; will prompt below if missing docId\n\n    const question = inputMessage.trim();\n    setInputMessage('');\n    setIsLoading(true);\n    setError('');\n\n    // Clear suggested question after use\n    if (suggestedQuestion && onSuggestedQuestionUsed) {\n      onSuggestedQuestionUsed();\n    }\n    try {\n      const response = await generateAIResponse(question);\n      onNewMessage(question, response);\n    } catch (err) {\n      setError(`Error getting AI response: ${err.message}`);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const generateAIResponse = async question => {\n    // If backend docId exists on documentInfo, use backend similarity search first\n    if (documentInfo && documentInfo.docId) {\n      try {\n        var _res$data;\n        const res = await axios.post('http://127.0.0.1:8000/query', {\n          doc_id: documentInfo.docId,\n          question,\n          top_k: 5\n        }, {\n          timeout: 20000\n        });\n        const hits = ((_res$data = res.data) === null || _res$data === void 0 ? void 0 : _res$data.results) || [];\n        const context = hits.map((h, i) => `[p:${h.page}] ${h.text}`).join('\\n\\n');\n        const prompt = `You are a helpful AI assistant. Use the context to answer.\\n\\nContext:\\n${context}\\n\\nQuestion: ${question}\\n\\nAnswer:`;\n        return await callGemini(prompt);\n      } catch (e) {\n        console.warn('Backend query failed, falling back to client mode', e);\n      }\n    }\n    try {\n      // Get relevant text chunks from the PDF for context\n      let contextText = \"\";\n      if (documentInfo && documentInfo.textChunks) {\n        // Use more chunks for better context (first 5 chunks)\n        const relevantChunks = documentInfo.textChunks.slice(0, 5);\n        contextText = relevantChunks.map((chunk, index) => `[Page ${chunk.page}, Chunk ${index + 1}]: ${chunk.text}`).join('\\n\\n');\n        console.log(`Using ${relevantChunks.length} chunks from pages: ${relevantChunks.map(c => c.page).join(', ')}`);\n      }\n\n      // Create a context-aware prompt for PDF Q&A\n      const prompt = `You are a helpful AI assistant helping users understand PDF documents. \n\nContext from the uploaded PDF:\n${contextText || \"PDF content is being processed. Please ask general questions about the document.\"}\n\nUser Question: ${question}\n\nPlease provide a helpful, informative response based on the PDF context above. If the question is about specific content in the PDF, use the context to answer it clearly. If it's a general question about the document, provide relevant insights based on what you can see.\n\nAnswer:`;\n      console.log('Sending request to Gemini API with context...');\n      console.log('Context length:', contextText.length);\n      const response = await axios.post(GEMINI_API_URL, {\n        contents: [{\n          parts: [{\n            text: prompt\n          }]\n        }],\n        generationConfig: {\n          temperature: 0.7,\n          topK: 40,\n          topP: 0.95,\n          maxOutputTokens: 1024\n        },\n        safetySettings: [{\n          category: \"HARM_CATEGORY_HARASSMENT\",\n          threshold: \"BLOCK_MEDIUM_AND_ABOVE\"\n        }, {\n          category: \"HARM_CATEGORY_HATE_SPEECH\",\n          threshold: \"BLOCK_MEDIUM_AND_ABOVE\"\n        }, {\n          category: \"HARM_CATEGORY_SEXUALLY_EXPLICIT\",\n          threshold: \"BLOCK_MEDIUM_AND_ABOVE\"\n        }, {\n          category: \"HARM_CATEGORY_DANGEROUS_CONTENT\",\n          threshold: \"BLOCK_MEDIUM_AND_ABOVE\"\n        }]\n      }, {\n        headers: {\n          'Content-Type': 'application/json',\n          'x-goog-api-key': GEMINI_API_KEY\n        },\n        timeout: 30000 // 30 second timeout\n      });\n      console.log('Gemini API Response:', response.data);\n      if (response.data && response.data.candidates && response.data.candidates.length > 0) {\n        const candidate = response.data.candidates[0];\n        if (candidate.content && candidate.content.parts && candidate.content.parts.length > 0) {\n          const generatedText = candidate.content.parts[0].text;\n          if (generatedText && generatedText.trim().length > 0) {\n            return generatedText.trim();\n          } else {\n            throw new Error('Generated response is empty');\n          }\n        } else {\n          throw new Error('Invalid response structure from Gemini API');\n        }\n      } else {\n        throw new Error('No response candidates from Gemini API');\n      }\n    } catch (error) {\n      console.error('Gemini API Error:', error);\n      if (error.response) {\n        // Server responded with error status\n        if (error.response.status === 400) {\n          throw new Error('Invalid request to Gemini API. Please check your API key and try again.');\n        } else if (error.response.status === 401) {\n          throw new Error('Invalid API key. Please check your Google Gemini API key.');\n        } else if (error.response.status === 403) {\n          throw new Error('Access denied. Please check your API key permissions.');\n        } else if (error.response.status === 429) {\n          throw new Error('Rate limit exceeded. Please wait a moment before asking another question.');\n        } else if (error.response.status === 500) {\n          throw new Error('Gemini API server error. Please try again in a few minutes.');\n        } else if (error.response.status === 404) {\n          throw new Error('Gemini model not found. Please try again later.');\n        } else {\n          throw new Error(`Gemini API Error ${error.response.status}: ${error.response.statusText}`);\n        }\n      } else if (error.request) {\n        // Request was made but no response received\n        throw new Error('No response from Gemini API. Please check your internet connection and try again.');\n      } else {\n        // Something else happened\n        throw new Error(error.message || 'Failed to connect to Gemini API. Please try again.');\n      }\n    }\n  };\n  const handleKeyPress = e => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    }\n  };\n  const handleAttachClick = () => {\n    var _fileInputRef$current;\n    (_fileInputRef$current = fileInputRef.current) === null || _fileInputRef$current === void 0 ? void 0 : _fileInputRef$current.click();\n  };\n  const handleFileSelected = e => {\n    var _e$target$files;\n    const file = (_e$target$files = e.target.files) === null || _e$target$files === void 0 ? void 0 : _e$target$files[0];\n    if (file && file.type.includes('pdf') && onUploadFile) {\n      onUploadFile(file);\n    }\n    e.target.value = '';\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bg-white rounded-lg shadow-sm\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-6 h-96 overflow-y-auto\",\n      children: conversationHistory.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center text-gray-500 py-8\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: documentInfo ? 'Start asking questions about your PDF document!' : 'Please upload a PDF first to begin chatting.'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-4\",\n        children: [conversationHistory.map((message, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"animate-fade-in\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-end mb-3\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-primary text-white px-4 py-2 rounded-2xl rounded-br-md max-w-xs lg:max-w-md\",\n              children: message.question\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 246,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 245,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-start mb-3\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-gray-100 text-gray-800 px-4 py-2 rounded-2xl rounded-bl-md max-w-xs lg:max-w-md\",\n              children: message.answer\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 253,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 252,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs text-gray-400 text-center mb-4\",\n            children: message.timestamp.toLocaleTimeString()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 259,\n            columnNumber: 17\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 15\n        }, this)), isLoading && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-start mb-3\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-gray-100 text-gray-800 px-4 py-2 rounded-2xl rounded-bl-md\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center gap-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"animate-spin rounded-full h-4 w-4 border-b-2 border-primary\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 270,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"AI is thinking...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 271,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 269,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 268,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: messagesEndRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 277,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"px-6 pb-4\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-red-50 border border-red-200 rounded-lg p-3 flex items-center gap-2\",\n        children: [/*#__PURE__*/_jsxDEV(AlertCircle, {\n          className: \"text-red-500\",\n          size: 16\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 286,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-red-700 text-sm\",\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 287,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 284,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"border-t p-4 bg-white\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"max-w-3xl mx-auto\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"rounded-2xl border shadow-sm px-3 py-2\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center gap-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              value: inputMessage,\n              onChange: e => setInputMessage(e.target.value),\n              onKeyPress: handleKeyPress,\n              placeholder: \"Ask anything\",\n              className: \"flex-1 px-3 py-2 outline-none\",\n              disabled: isLoading\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 297,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              ref: fileInputRef,\n              type: \"file\",\n              accept: \".pdf\",\n              className: \"hidden\",\n              onChange: handleFileSelected\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 307,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              onClick: handleAttachClick,\n              title: \"Attach PDF\",\n              className: \"w-9 h-9 rounded-full border bg-gray-50 hover:bg-gray-100 flex items-center justify-center\",\n              children: /*#__PURE__*/_jsxDEV(Plus, {\n                size: 16\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 314,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 308,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: handleSendMessage,\n              disabled: !inputMessage.trim() || isLoading,\n              className: \"bg-primary hover:bg-primary/90 disabled:bg-gray-300 text-white px-4 py-2 rounded-full transition-colors flex items-center gap-2\",\n              children: [/*#__PURE__*/_jsxDEV(Send, {\n                size: 16\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 321,\n                columnNumber: 17\n              }, this), \"Send\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 316,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 296,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 295,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 293,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 233,\n    columnNumber: 5\n  }, this);\n};\n_s(ChatInterface, \"GhedN+1JTs+FMDMUCeWFh5KqbbQ=\");\n_c = ChatInterface;\nexport default ChatInterface;\nvar _c;\n$RefreshReg$(_c, \"ChatInterface\");","map":{"version":3,"names":["React","useState","useRef","useEffect","Send","AlertCircle","Plus","axios","jsxDEV","_jsxDEV","GEMINI_API_KEY","GEMINI_API_URL","callGemini","prompt","_response$data","_response$data$candid","response","post","contents","parts","text","generationConfig","temperature","topK","topP","maxOutputTokens","safetySettings","category","threshold","headers","timeout","data","candidates","length","_response$data$candid2","_response$data$candid3","_response$data$candid4","_response$data$candid5","t","content","trim","Error","ChatInterface","conversationHistory","onNewMessage","documentInfo","suggestedQuestion","onSuggestedQuestionUsed","onUploadFile","_s","inputMessage","setInputMessage","isLoading","setIsLoading","error","setError","messagesEndRef","fileInputRef","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","handleSendMessage","question","generateAIResponse","err","message","docId","_res$data","res","doc_id","top_k","hits","results","context","map","h","i","page","join","e","console","warn","contextText","textChunks","relevantChunks","slice","chunk","index","log","c","candidate","generatedText","status","statusText","request","handleKeyPress","key","shiftKey","preventDefault","handleAttachClick","_fileInputRef$current","click","handleFileSelected","_e$target$files","file","target","files","type","includes","value","className","children","fileName","_jsxFileName","lineNumber","columnNumber","answer","timestamp","toLocaleTimeString","ref","size","onChange","onKeyPress","placeholder","disabled","accept","onClick","title","_c","$RefreshReg$"],"sources":["C:/Users/sanja/Pdfc/src/components/ChatInterface.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport { Send, AlertCircle, Plus } from 'lucide-react';\nimport axios from 'axios';\n\n// Add your Gemini API key here\nconst GEMINI_API_KEY = \"AIzaSyAVnKwouHnPokho-KTK7KaEWQ4-1VuXm1g\";\nconst GEMINI_API_URL = \"https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent\";\nconst callGemini = async (prompt) => {\n  const response = await axios.post(\n    GEMINI_API_URL,\n    {\n      contents: [{ parts: [{ text: prompt }] }],\n      generationConfig: { temperature: 0.7, topK: 40, topP: 0.95, maxOutputTokens: 1024 },\n      safetySettings: [\n        { category: \"HARM_CATEGORY_HARASSMENT\", threshold: \"BLOCK_MEDIUM_AND_ABOVE\" },\n        { category: \"HARM_CATEGORY_HATE_SPEECH\", threshold: \"BLOCK_MEDIUM_AND_ABOVE\" },\n        { category: \"HARM_CATEGORY_SEXUALLY_EXPLICIT\", threshold: \"BLOCK_MEDIUM_AND_ABOVE\" },\n        { category: \"HARM_CATEGORY_DANGEROUS_CONTENT\", threshold: \"BLOCK_MEDIUM_AND_ABOVE\" }\n      ]\n    },\n    { headers: { 'Content-Type': 'application/json', 'x-goog-api-key': GEMINI_API_KEY }, timeout: 30000 }\n  );\n  if (response.data?.candidates?.length > 0) {\n    const t = response.data.candidates[0]?.content?.parts?.[0]?.text || '';\n    return t.trim() || 'I could not generate an answer.';\n  }\n  throw new Error('Invalid response from Gemini');\n};\n\nconst ChatInterface = ({ conversationHistory, onNewMessage, documentInfo, suggestedQuestion, onSuggestedQuestionUsed, onUploadFile }) => {\n  const [inputMessage, setInputMessage] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState('');\n  const messagesEndRef = useRef(null);\n  const fileInputRef = useRef(null);\n\n  // Set suggested question when it changes\n  useEffect(() => {\n    if (suggestedQuestion) {\n      setInputMessage(suggestedQuestion);\n    }\n  }, [suggestedQuestion]);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [conversationHistory]);\n\n  const handleSendMessage = async () => {\n    if (!inputMessage.trim() || isLoading) return;\n    // Allow asking even before upload; will prompt below if missing docId\n\n    const question = inputMessage.trim();\n    setInputMessage('');\n    setIsLoading(true);\n    setError('');\n\n    // Clear suggested question after use\n    if (suggestedQuestion && onSuggestedQuestionUsed) {\n      onSuggestedQuestionUsed();\n    }\n\n    try {\n      const response = await generateAIResponse(question);\n      onNewMessage(question, response);\n    } catch (err) {\n      setError(`Error getting AI response: ${err.message}`);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const generateAIResponse = async (question) => {\n    // If backend docId exists on documentInfo, use backend similarity search first\n    if (documentInfo && documentInfo.docId) {\n      try {\n        const res = await axios.post('http://127.0.0.1:8000/query', {\n          doc_id: documentInfo.docId,\n          question,\n          top_k: 5\n        }, { timeout: 20000 });\n        const hits = res.data?.results || [];\n        const context = hits.map((h, i) => `[p:${h.page}] ${h.text}`).join('\\n\\n');\n        const prompt = `You are a helpful AI assistant. Use the context to answer.\\n\\nContext:\\n${context}\\n\\nQuestion: ${question}\\n\\nAnswer:`;\n        return await callGemini(prompt);\n      } catch (e) {\n        console.warn('Backend query failed, falling back to client mode', e);\n      }\n    }\n    try {\n      // Get relevant text chunks from the PDF for context\n      let contextText = \"\";\n      if (documentInfo && documentInfo.textChunks) {\n        // Use more chunks for better context (first 5 chunks)\n        const relevantChunks = documentInfo.textChunks.slice(0, 5);\n        contextText = relevantChunks.map((chunk, index) => \n          `[Page ${chunk.page}, Chunk ${index + 1}]: ${chunk.text}`\n        ).join('\\n\\n');\n        \n        console.log(`Using ${relevantChunks.length} chunks from pages: ${relevantChunks.map(c => c.page).join(', ')}`);\n      }\n\n      // Create a context-aware prompt for PDF Q&A\n      const prompt = `You are a helpful AI assistant helping users understand PDF documents. \n\nContext from the uploaded PDF:\n${contextText || \"PDF content is being processed. Please ask general questions about the document.\"}\n\nUser Question: ${question}\n\nPlease provide a helpful, informative response based on the PDF context above. If the question is about specific content in the PDF, use the context to answer it clearly. If it's a general question about the document, provide relevant insights based on what you can see.\n\nAnswer:`;\n\n      console.log('Sending request to Gemini API with context...');\n      console.log('Context length:', contextText.length);\n      \n      const response = await axios.post(\n        GEMINI_API_URL,\n        {\n          contents: [{\n            parts: [{\n              text: prompt\n            }]\n          }],\n          generationConfig: {\n            temperature: 0.7,\n            topK: 40,\n            topP: 0.95,\n            maxOutputTokens: 1024,\n          },\n          safetySettings: [\n            {\n              category: \"HARM_CATEGORY_HARASSMENT\",\n              threshold: \"BLOCK_MEDIUM_AND_ABOVE\"\n            },\n            {\n              category: \"HARM_CATEGORY_HATE_SPEECH\",\n              threshold: \"BLOCK_MEDIUM_AND_ABOVE\"\n            },\n            {\n              category: \"HARM_CATEGORY_SEXUALLY_EXPLICIT\",\n              threshold: \"BLOCK_MEDIUM_AND_ABOVE\"\n            },\n            {\n              category: \"HARM_CATEGORY_DANGEROUS_CONTENT\",\n              threshold: \"BLOCK_MEDIUM_AND_ABOVE\"\n            }\n          ]\n        },\n        {\n          headers: {\n            'Content-Type': 'application/json',\n            'x-goog-api-key': GEMINI_API_KEY\n          },\n          timeout: 30000 // 30 second timeout\n        }\n      );\n\n      console.log('Gemini API Response:', response.data);\n\n      if (response.data && response.data.candidates && response.data.candidates.length > 0) {\n        const candidate = response.data.candidates[0];\n        if (candidate.content && candidate.content.parts && candidate.content.parts.length > 0) {\n          const generatedText = candidate.content.parts[0].text;\n          \n          if (generatedText && generatedText.trim().length > 0) {\n            return generatedText.trim();\n          } else {\n            throw new Error('Generated response is empty');\n          }\n        } else {\n          throw new Error('Invalid response structure from Gemini API');\n        }\n      } else {\n        throw new Error('No response candidates from Gemini API');\n      }\n      \n    } catch (error) {\n      console.error('Gemini API Error:', error);\n      \n      if (error.response) {\n        // Server responded with error status\n        if (error.response.status === 400) {\n          throw new Error('Invalid request to Gemini API. Please check your API key and try again.');\n        } else if (error.response.status === 401) {\n          throw new Error('Invalid API key. Please check your Google Gemini API key.');\n        } else if (error.response.status === 403) {\n          throw new Error('Access denied. Please check your API key permissions.');\n        } else if (error.response.status === 429) {\n          throw new Error('Rate limit exceeded. Please wait a moment before asking another question.');\n        } else if (error.response.status === 500) {\n          throw new Error('Gemini API server error. Please try again in a few minutes.');\n        } else if (error.response.status === 404) {\n          throw new Error('Gemini model not found. Please try again later.');\n        } else {\n          throw new Error(`Gemini API Error ${error.response.status}: ${error.response.statusText}`);\n        }\n      } else if (error.request) {\n        // Request was made but no response received\n        throw new Error('No response from Gemini API. Please check your internet connection and try again.');\n      } else {\n        // Something else happened\n        throw new Error(error.message || 'Failed to connect to Gemini API. Please try again.');\n      }\n    }\n  };\n\n  const handleKeyPress = (e) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    }\n  };\n\n  const handleAttachClick = () => {\n    fileInputRef.current?.click();\n  };\n\n  const handleFileSelected = (e) => {\n    const file = e.target.files?.[0];\n    if (file && file.type.includes('pdf') && onUploadFile) {\n      onUploadFile(file);\n    }\n    e.target.value = '';\n  };\n\n\n  return (\n    <div className=\"bg-white rounded-lg shadow-sm\">\n      {/* Chat Messages */}\n      <div className=\"p-6 h-96 overflow-y-auto\">\n        {conversationHistory.length === 0 ? (\n          <div className=\"text-center text-gray-500 py-8\">\n            <p>{documentInfo ? 'Start asking questions about your PDF document!' : 'Please upload a PDF first to begin chatting.'}</p>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {conversationHistory.map((message, index) => (\n              <div key={index} className=\"animate-fade-in\">\n                {/* User Message */}\n                <div className=\"flex justify-end mb-3\">\n                  <div className=\"bg-primary text-white px-4 py-2 rounded-2xl rounded-br-md max-w-xs lg:max-w-md\">\n                    {message.question}\n                  </div>\n                </div>\n                \n                {/* AI Response */}\n                <div className=\"flex justify-start mb-3\">\n                  <div className=\"bg-gray-100 text-gray-800 px-4 py-2 rounded-2xl rounded-bl-md max-w-xs lg:max-w-md\">\n                    {message.answer}\n                  </div>\n                </div>\n                \n                {/* Timestamp */}\n                <div className=\"text-xs text-gray-400 text-center mb-4\">\n                  {message.timestamp.toLocaleTimeString()}\n                </div>\n              </div>\n            ))}\n            \n            {/* Loading indicator */}\n            {isLoading && (\n              <div className=\"flex justify-start mb-3\">\n                <div className=\"bg-gray-100 text-gray-800 px-4 py-2 rounded-2xl rounded-bl-md\">\n                  <div className=\"flex items-center gap-2\">\n                    <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-primary\"></div>\n                    <span>AI is thinking...</span>\n                  </div>\n                </div>\n              </div>\n            )}\n            \n            <div ref={messagesEndRef} />\n          </div>\n        )}\n      </div>\n\n      {/* Error Display */}\n      {error && (\n        <div className=\"px-6 pb-4\">\n          <div className=\"bg-red-50 border border-red-200 rounded-lg p-3 flex items-center gap-2\">\n            <AlertCircle className=\"text-red-500\" size={16} />\n            <span className=\"text-red-700 text-sm\">{error}</span>\n          </div>\n        </div>\n      )}\n\n      {/* Input Section - OpenAI-like composer with action chips */}\n      <div className=\"border-t p-4 bg-white\">\n        <div className=\"max-w-3xl mx-auto\">\n          <div className=\"rounded-2xl border shadow-sm px-3 py-2\">\n            <div className=\"flex items-center gap-2\">\n              <input\n                type=\"text\"\n                value={inputMessage}\n                onChange={(e) => setInputMessage(e.target.value)}\n                onKeyPress={handleKeyPress}\n                placeholder=\"Ask anything\"\n                className=\"flex-1 px-3 py-2 outline-none\"\n                disabled={isLoading}\n              />\n              {/* Plus button to upload inside composer */}\n              <input ref={fileInputRef} type=\"file\" accept=\".pdf\" className=\"hidden\" onChange={handleFileSelected} />\n              <button\n                type=\"button\"\n                onClick={handleAttachClick}\n                title=\"Attach PDF\"\n                className=\"w-9 h-9 rounded-full border bg-gray-50 hover:bg-gray-100 flex items-center justify-center\"\n              >\n                <Plus size={16} />\n              </button>\n              <button\n                onClick={handleSendMessage}\n                disabled={!inputMessage.trim() || isLoading}\n                className=\"bg-primary hover:bg-primary/90 disabled:bg-gray-300 text-white px-4 py-2 rounded-full transition-colors flex items-center gap-2\"\n              >\n                <Send size={16} />\n                Send\n              </button>\n            </div>\n            {/* No extra action chips here to keep only the global \"+\" uploader */}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ChatInterface;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}